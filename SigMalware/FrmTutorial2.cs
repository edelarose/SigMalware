using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.IO;
using System.Security;
using System.Security.Cryptography;
using System.Linq;
using System.Text;
using System.Windows.Forms;

namespace SigMalware
{
    public partial class FrmTutorial2 : Form
    {
        public FrmTutorial2()
        {
            InitializeComponent();
        }
        public string GenerateSig(string sData, string sSharedKey)
        {
            //get shared key bytes
            byte[] key = Encoding.ASCII.GetBytes(sSharedKey);
            HMACSHA256 hmac = new HMACSHA256(key);
            //calculate new key
            byte[] newKey = hmac.ComputeHash(Encoding.ASCII.GetBytes(sData));
            return ToHexString(newKey).ToLower();
 
        }
        public static string ToHexString(byte[] bytes){
            string hexString = "";
            for (int i = 0; i < bytes.Length; i++)
            {
                hexString += bytes.ToString();
            }
            return hexString;
        }
            
            
          
    }
}
