using System;
using System.IO;
using System.Security.Principal;

namespace Common.Lib.dll.Presenters
{
    public class HostsPresenter
    {
        private IHostsView _View;
        public HostsPresenter(IHostsView view)
        {
            _View = view;
        }
        public void PopulateGrid()
        {
            //check if admin account used to access hosts
            WindowsPrincipal pr = new WindowsPrincipal(WindowsIdentity.GetCurrent());
            bool admin = pr.IsInRole(WindowsBuiltInRole.Administrator);
            if (!admin)
            {
                _View.adminStatus = "Not admin";
            }
            else
            {
                string path = Environment.GetFolderPath(Environment.SpecialFolder.System) + @"\drivers\etc\hosts";
                FileStream file = File.Open(path, FileMode.Open, FileAccess.Read);
                StreamReader reader = new StreamReader(file);
                string hostsText = reader.ReadToEnd();
                file.Close();
                reader.Close();
                String[] hostsArr = hostsText.Split(new char[] { '\n' });
                _View.hostsArray = hostsArr;
            }

        }

        public interface IHostsView
        {
        #region Accessors
            String[] hostsArray { set; }
            string adminStatus { set; }
        #endregion
        }
    }   
}
